'use strict';var DynamicDataTableManager=function(){var data={tableSelector:'.basic-datatable',dataTables:{},dataTableSettings:{},};var inMethods={init:function(id,tableDom,columnSearchStatus,dataTableOptions){inMethods.getFilterData(id,function(filterData){dataTableOptions.ajax.data=filterData;data.dataTables[id]=tableDom.DataTable(dataTableOptions);$('[data-basic-datatable-filter="'+id+'"] .btn-filter').addClass('disabled').children('i').addClass('fa-spin');if(columnSearchStatus){data.dataTables[id].initComplete=function(){this.api().columns().every(function(){var column=this;var input=document.createElement("input");$(input).appendTo($(column.footer()).empty()).on('change',function(){column.search($(this).val(),false,false,true).draw();});});}}
data.dataTables[id].on('preXhr',function(e,settings,xhRdata){$('[data-basic-datatable-filter="'+id+'"] .btn-filter').addClass('disabled').children('i').addClass('fa-spin');$('[aria-controls="'+id+'"].table-draw span i').addClass('fa-spin').addClass('text-red');$('[aria-controls="'+id+'"].paginate_button.active a').html('<i class="fa-spinner fa-spin"></i>');}).on('draw.dt',function(){$('[data-toggle="tooltip"]',data.dataTableSettings[id].tableDom).tooltip();$('[data-toggle="popover"]',data.dataTableSettings[id].tableDom).popover();$.applyMasks(data.dataTableSettings[id].tableDom);$.applyDatePickers(data.dataTableSettings[id].tableDom);$('[data-basic-datatable-filter="'+id+'"] .btn-filter').removeClass('disabled').removeClass('btn-danger').addClass('btn-default').children('i').removeClass('fa-spin').addClass('text-success');$('[aria-controls="'+id+'"].table-draw span i').removeClass('fa-spin').removeClass('text-red');});$('[aria-controls="'+id+'"].table-draw').click(function(){data.dataTables[id].settings()[0].jqXHR.abort();inMethods.getFilterData(id,function(filterData){data.dataTables[id].context[0].ajax.data=filterData;data.dataTables[id].draw();});});$('div.dataTables_filter input[aria-controls="'+id+'"]').off('keyup.DT input.DT');});},getFilterData:function(id,callback){var filterData={};var area=$('.basic-datatable-filters[data-table="'+id+'"]');if(area.length===0){area=$('[data-basic-datatable-filter="'+id+'"]');}
if(area.length>0){$('input, textarea',area).each(function(i,ui){var inputDom=$(this);var name=inputDom.attr('name');if(typeof name!==typeof undefined&&name!==null){if(inputDom.attr('type')==='checkbox'||inputDom.attr('type')==='radio'){if(inputDom.is(':checked')){filterData[name]=inputDom.val();}}
else{var inputVal=inputDom.val();if(typeof inputVal!==typeof undefined&&inputVal!==null){filterData[name]=inputVal;}}}});$('select',area).each(function(){var selectDom=$(this);var multiple=selectDom.prop('multiple');var name=selectDom.attr('name');if(typeof name!==typeof undefined&&name!==null){if(multiple){name=name.replace('[]','');filterData[name]=[];$('option:selected',selectDom).each(function(){filterData[name].push($(this).val());});}else{var optionValue=$('option:selected',selectDom).val();if(typeof optionValue!==typeof undefined&&optionValue!==null){filterData[name]=optionValue;}}}});}
if(typeof callback!==typeof undefined){callback(filterData);}},lazyInit:function(id){var settings=data.dataTableSettings[id];inMethods.init(settings.id,settings.tableDom,settings.columnSearchStatus,settings.dataTableOptions);},drawDataTable:function(id){data.dataTables[id].settings()[0].jqXHR.abort();data.dataTables[id].draw();}};var registrations={collect:function(){$(data.tableSelector).each(function(){var tableDom=$(this);var id=tableDom.attr('id');var data_url=tableDom.attr('data-data-url');var columnSearchStatus=tableDom.attr('data-column-search');columnSearchStatus=typeof columnSearchStatus!==typeof undefined&&columnSearchStatus==='1';var responsive=tableDom.attr('data-responsive');responsive=typeof responsive!==typeof undefined&&responsive==='1';var columns=$.parseJSON(tableDom.attr('data-columns'));var order=[];var initLoad=tableDom.attr('data-init-load');for(var i=0;i<columns.length;i++){if(typeof columns[i].order!==typeof undefined){order.push([i,columns[i].order]);}}
var options={responsive:responsive,searching:true,processing:false,serverSide:true,lengthMenu:[25,50,100],ajax:{url:data_url},columns:columns,order:order,language:{"lengthMenu":"Sayfada _MENU_ kayıt göster","zeroRecords":"Bulunamadı","info":"Toplam _PAGES_ sayfadan _PAGE_ sayfa gösteriliyor. (_START_-_END_ arası | Toplam: _TOTAL_)","infoEmpty":"Kayıt yok","infoFiltered":"(toplam _MAX_ kayıttan filtrelendi)",'search':'Ara',"decimal":"","emptyTable":"Kayıt yok","infoPostFix":"","thousands":",","loadingRecords":"Yükleniyor...","processing":"İşleniyor...","paginate":{"first":"İlk","last":"Son","next":"Sonraki","previous":"Önceki"},"aria":{"sortAscending":": küçükten buyüğe sıralı","sortDescending":": büyükten küçüğe sıralı"}},dom:"<'row'<'col-sm-5'l><'col-sm-7'Tf>r>"+
"t"+
"<'row'<'col-xs-6'i><'col-xs-6'p>>",tableTools:{sSwfPath:app_url+'/js/datatables/tabletools/copy_csv_xls_pdf.swf','aButtons':[{'sExtends':'text','sButtonText':'<i class="fa-refresh"></i>','sButtonClass':"table-draw"},'print',]}};data.dataTableSettings[id]={id:id,tableDom:tableDom,dataTableOptions:options,columnSearchStatus:columnSearchStatus,lastSearchVal:'',timer:null,};if(typeof initLoad===typeof undefined||initLoad!=='disabled'){inMethods.init(id,tableDom,columnSearchStatus,options);}});},filter:function(){$('.basic-datatable-filters').on('change dp.change','input,select,textarea',function(){var table_id=$(this).parents('.basic-datatable-filters').attr('data-table');inMethods.getFilterData(table_id,function(filterData){data.dataTables[table_id].context[0].ajax.data=filterData;inMethods.drawDataTable(table_id);});});$('[data-basic-datatable-filter]').on('click','.btn-filter',function(){if(!$(this).hasClass('disabled')){var table_id=$(this).parents('[data-basic-datatable-filter]').attr('data-basic-datatable-filter');inMethods.getFilterData(table_id,function(filterData){data.dataTables[table_id].context[0].ajax.data=filterData;data.dataTables[table_id].draw();});}}).on('change dp.change','input,select,textarea',function(){$('.btn-filter').removeClass('btn-default').addClass('btn-danger').children('i').removeClass('text-success');}).on('click','.btn-export',function(){var button=$(this);if(!button.hasClass('disabled')){var table_id=button.parents('[data-basic-datatable-filter]').attr('data-basic-datatable-filter');inMethods.getFilterData(table_id,function(filterData){var form=$('form[name="'+table_id+'"]');form.attr('method','post');form.attr('action',button.attr('data-action'));form.attr('target','_blank');setTimeout(function(){form.submit();setTimeout(function(){form.removeAttr('method');form.removeAttr('target');form.attr('action','javascript:void(0);');},250);},250);});}});},search:function(){$('div.dataTables_filter input').on('keyup',function(){var input=$(this);var id=input.attr('aria-controls');var value=input.val();clearInterval(data.dataTableSettings[id].timer);data.dataTableSettings[id].timer=setInterval(function(){clearInterval(data.dataTableSettings[id].timer);if(data.dataTableSettings[id].lastSearchVal!==value){data.dataTableSettings[id].lastSearchVal=value;data.dataTables[id].search(value);inMethods.getFilterData(id,function(filterData){data.dataTables[id].context[0].ajax.data=filterData;inMethods.drawDataTable(id);});}},250);});}};this.methods={getDatatable:function(id){return data.dataTables[id];},lazyInit:function(id){inMethods.lazyInit(id);},draw:function(id){return inMethods.drawDataTable(id);},};this.register=function(){registrations.collect();registrations.filter();registrations.search();};};var dynamicDataTables=new DynamicDataTableManager();$(document).ready(function(){dynamicDataTables.register();});